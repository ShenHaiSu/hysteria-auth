import{U as W,k as V,H as R,i as S,J as A,b,e,l as a,p as l,E as L,o as x,w as _,v as y,d as U,n as z,g as M,a as X,F as Z,A as ee,I as te,c as F,G as q,C as se,t as T,K as oe,L as le}from"./index-CurZRE90.js";import{u as Y}from"./node-XxXxMLNn.js";import{a as $}from"./index-9NuiK9eO.js";import{c as re,b as ie}from"./index-Dy6SO-wM.js";import{a as k}from"./index-BVYfK-K8.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as ae,a as w,b as ne,f as B,c as j,d as K,e as de}from"./index-BOg_vN7t.js";import{s as I}from"./index-CbIDIgY1.js";import"./node-rrHiEOCh.js";function ue(){const o=Y(),{nodes:g,loading:v}=W(o),f=V({server_group:"",ip_address:"",domain:"",is_active:void 0,expire_from:void 0,expire_to:void 0});async function c(){const t={};f.value.server_group&&(t.server_group=f.value.server_group),f.value.ip_address&&(t.ip_address=f.value.ip_address),f.value.domain&&(t.domain=f.value.domain),f.value.is_active!==void 0&&(t.is_active=f.value.is_active),f.value.expire_from&&(t.expire_from=f.value.expire_from),f.value.expire_to&&(t.expire_to=f.value.expire_to),await o.fetchNodes(t)}function m(){f.value={server_group:"",ip_address:"",domain:"",is_active:void 0,expire_from:void 0,expire_to:void 0},c()}return R(()=>{c()}),{nodes:g,loading:v,filters:f,loadNodes:c,resetFilters:m}}function fe(){const o=V(!1),g=V(!1),v=V("add"),f=V(null),c={ip_address:"",domain:null,server_group:"default",salamander:"",idc_name:null,rent_ts:Math.floor(Date.now()/1e3),expire_ts:0,fee:0,proxy_port:"20000-30000",server_port:null,note1:null,note2:null,note3:null,note4:null,is_active:1},m=V({...c});function t(){v.value="add",f.value=null,m.value={...c},o.value=!0}function n(d){v.value="edit",f.value=d,m.value={ip_address:d.ip_address,domain:d.domain,server_group:d.server_group,salamander:d.salamander,idc_name:d.idc_name,rent_ts:d.rent_ts,expire_ts:d.expire_ts,fee:d.fee,proxy_port:d.proxy_port,server_port:d.server_port,note1:d.note1,note2:d.note2,note3:d.note3,note4:d.note4,is_active:d.is_active},o.value=!0}function i(d){v.value="add",f.value=null,m.value={...c,server_group:d.server_group,salamander:d.salamander,idc_name:d.idc_name,fee:d.fee,proxy_port:d.proxy_port,server_port:d.server_port,rent_ts:d.rent_ts,expire_ts:d.expire_ts,is_active:1},o.value=!0}function r(){o.value=!1}return{visible:o,loading:g,mode:v,form:m,currentNode:f,openAdd:t,openEdit:n,openCopy:i,close:r}}const me={class:"bg-surface-0 dark:bg-surface-900 p-4 rounded-lg shadow-sm mb-4 border border-surface-200 dark:border-surface-700"},ce={class:"flex flex-wrap gap-4 items-end"},pe={class:"flex flex-col gap-2"},ve={class:"flex flex-col gap-2"},xe={class:"flex flex-col gap-2"},ge={class:"flex flex-col gap-2"},be={class:"flex items-center gap-2 ml-auto"},ye=S({__name:"NodeFilter",props:{filters:{}},emits:["search","reset","add"],setup(o,{emit:g}){const v=o,f=g,c=V([{label:"已启用",value:1},{label:"已禁用",value:0}]),m=V(null),t=V(null);A(()=>v.filters,r=>{r.expire_from||(m.value=null),r.expire_to||(t.value=null)},{deep:!0});function n(){f("search")}function i(){m.value=null,t.value=null,f("reset")}return(r,d)=>(x(),b("div",me,[e("div",ce,[e("div",pe,[d[5]||(d[5]=e("label",{for:"server_group",class:"text-sm font-medium text-surface-600 dark:text-surface-400"},"节点分组",-1)),a(l($),{id:"server_group",modelValue:o.filters.server_group,"onUpdate:modelValue":d[0]||(d[0]=p=>o.filters.server_group=p),placeholder:"搜索分组...",class:"w-full md:w-48",onKeyup:L(n,["enter"])},null,8,["modelValue"])]),e("div",ve,[d[6]||(d[6]=e("label",{for:"ip_address",class:"text-sm font-medium text-surface-600 dark:text-surface-400"},"IP 地址",-1)),a(l($),{id:"ip_address",modelValue:o.filters.ip_address,"onUpdate:modelValue":d[1]||(d[1]=p=>o.filters.ip_address=p),placeholder:"搜索 IP...",class:"w-full md:w-48",onKeyup:L(n,["enter"])},null,8,["modelValue"])]),e("div",xe,[d[7]||(d[7]=e("label",{for:"domain",class:"text-sm font-medium text-surface-600 dark:text-surface-400"},"域名",-1)),a(l($),{id:"domain",modelValue:o.filters.domain,"onUpdate:modelValue":d[2]||(d[2]=p=>o.filters.domain=p),placeholder:"搜索域名...",class:"w-full md:w-48",onKeyup:L(n,["enter"])},null,8,["modelValue"])]),e("div",ge,[d[8]||(d[8]=e("label",{for:"is_active",class:"text-sm font-medium text-surface-600 dark:text-surface-400"},"启用状态",-1)),a(l(re),{id:"is_active",modelValue:o.filters.is_active,"onUpdate:modelValue":d[3]||(d[3]=p=>o.filters.is_active=p),options:c.value,optionLabel:"label",optionValue:"value",placeholder:"全部状态",class:"w-full md:w-48",showClear:"",onChange:n},null,8,["modelValue","options"])]),e("div",be,[a(l(k),{label:"重置",icon:"pi pi-refresh",severity:"secondary",onClick:i}),a(l(k),{label:"查询",icon:"pi pi-search",onClick:n}),a(l(k),{label:"新增节点",icon:"pi pi-plus",severity:"primary",onClick:d[4]||(d[4]=p=>r.$emit("add"))})])])]))}}),_e=P(ye,[["__scopeId","data-v-bdad3b8a"]]),$e={class:"bg-surface-0 dark:bg-surface-900 rounded-lg shadow-sm border border-surface-200 dark:border-surface-700 overflow-hidden"},ke={class:"font-mono text-sm"},Ve={class:"text-sm"},Ce={class:"flex items-center gap-2"},we={class:"text-sm"},Ne={class:"flex flex-col gap-1"},he={class:"flex items-center gap-1"},De={class:"text-sm font-mono"},Ue={key:0,class:"flex items-center gap-1"},Ie={class:"text-sm font-mono"},Se={class:"text-sm font-medium text-surface-700 dark:text-surface-200"},Me={class:"flex flex-col"},ze={class:"text-sm"},Ee={class:"flex gap-1"},Le={key:0,class:"pi pi-info-circle text-surface-400 cursor-help"},Te={key:1,class:"text-surface-400"},Fe={class:"flex gap-3 justify-end"},Pe=S({__name:"NodeListDesktop",props:{nodes:{},loading:{type:Boolean}},emits:["edit","delete","stop","copy"],setup(o){function g(t){return new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(t)}function v(t){return[t.note1,t.note2,t.note3,t.note4].filter(Boolean).join(" | ")||"无备注"}function f(t){return!t||t===0?"长期有效":new Date(t*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function c(t){if(!t)return"";const n=Math.floor(Date.now()/1e3),i=t-n;if(i<0)return"已过期";const r=Math.floor(i/86400);return r===0?"今日到期":r<7?`${r} 天后到期`:""}function m(t){if(!t)return"";const n=Math.floor(Date.now()/1e3),i=t-n;return i<0?"text-red-500 font-medium":i<86400*7?"text-orange-500 font-medium":"text-surface-500"}return(t,n)=>{const i=X("tooltip");return x(),b("div",$e,[a(l(ae),{value:o.nodes,loading:o.loading,dataKey:"id",responsiveLayout:"scroll",stripedRows:"",removableSort:"",rowHover:"",class:"p-datatable-sm",pt:{column:{headerCell:{class:"bg-surface-50 dark:bg-surface-800/50 text-surface-700 dark:text-surface-0/70 font-semibold py-3 border-b border-surface-200 dark:border-surface-700"},bodyCell:{class:"py-3 border-b border-surface-100 dark:border-surface-800"}}}},{empty:_(()=>[...n[0]||(n[0]=[e("div",{class:"flex flex-col items-center justify-center py-8 text-surface-500 dark:text-surface-400"},[e("i",{class:"pi pi-inbox text-4xl mb-2"}),e("span",null,"未找到匹配的节点")],-1)])]),default:_(()=>[a(l(w),{field:"server_group",header:"分组",sortable:""},{body:_(({data:r})=>[a(l(I),{value:r.server_group,severity:"info",class:"px-2"},null,8,["value"])]),_:1}),a(l(w),{field:"ip_address",header:"IP 地址",sortable:""},{body:_(({data:r})=>[e("span",ke,y(r.ip_address),1)]),_:1}),a(l(w),{field:"domain",header:"域名",sortable:""},{body:_(({data:r})=>[e("span",Ve,y(r.domain||"-"),1)]),_:1}),a(l(w),{field:"idc_name",header:"IDC",sortable:""},{body:_(({data:r})=>[e("div",Ce,[n[1]||(n[1]=e("i",{class:"pi pi-building text-surface-400 text-xs"},null,-1)),e("span",we,y(r.idc_name||"-"),1)])]),_:1}),a(l(w),{field:"proxy_port",header:"端口",sortable:""},{body:_(({data:r})=>[e("div",Ne,[e("div",he,[a(l(I),{value:"代理",severity:"secondary",class:"scale-75 origin-left"}),e("span",De,y(r.proxy_port),1)]),r.server_port?(x(),b("div",Ue,[a(l(I),{value:"服务",severity:"warn",class:"scale-75 origin-left"}),e("span",Ie,y(r.server_port),1)])):U("",!0)])]),_:1}),a(l(w),{field:"fee",header:"费用",sortable:""},{body:_(({data:r})=>[e("span",Se,y(g(r.fee)),1)]),_:1}),a(l(w),{field:"is_active",header:"状态",sortable:""},{body:_(({data:r})=>[a(l(I),{value:r.is_active?"启用":"停用",severity:r.is_active?"success":"danger"},null,8,["value","severity"])]),_:1}),a(l(w),{field:"expire_ts",header:"到期时间",sortable:""},{body:_(({data:r})=>[e("div",Me,[e("span",ze,y(f(r.expire_ts)),1),r.expire_ts?(x(),b("small",{key:0,class:z([m(r.expire_ts),"text-[10px] mt-1"])},y(c(r.expire_ts)),3)):U("",!0)])]),_:1}),a(l(w),{header:"备注"},{body:_(({data:r})=>[e("div",Ee,[r.note1||r.note2||r.note3||r.note4?M((x(),b("i",Le,null,512)),[[i,v(r),void 0,{top:!0}]]):(x(),b("span",Te,"-"))])]),_:1}),a(l(w),{header:"操作",exportable:!1},{body:_(({data:r})=>[e("div",Fe,[M(a(l(k),{icon:"pi pi-pencil",label:"编辑",severity:"secondary",size:"small",onClick:d=>t.$emit("edit",r)},null,8,["onClick"]),[[i,"编辑",void 0,{top:!0}]]),M(a(l(k),{icon:"pi pi-stop",label:r.is_active?"停用":"已停用",severity:"danger",size:"small",disabled:!r.is_active,onClick:d=>t.$emit("stop",r)},null,8,["label","disabled","onClick"]),[[i,r.is_active?"停用":"已停用",void 0,{top:!0}]]),M(a(l(k),{icon:"pi pi-copy",label:"复用",severity:"info",size:"small",onClick:d=>t.$emit("copy",r)},null,8,["onClick"]),[[i,"复用",void 0,{top:!0}]]),M(a(l(k),{icon:"pi pi-trash",label:"删除",severity:"danger",size:"small",onClick:d=>t.$emit("delete",r)},null,8,["onClick"]),[[i,"删除",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading"])])}}}),Be={class:"space-y-3"},je={key:0,class:"flex flex-col items-center justify-center py-12 bg-surface-0 dark:bg-surface-900 rounded-lg border border-surface-200 dark:border-surface-700"},Ke={class:"flex justify-between items-start"},Re={class:"flex flex-col gap-1"},Ae={class:"flex items-center gap-1 text-surface-500 dark:text-surface-400 mt-1"},qe={class:"text-xs font-medium"},Ye={class:"grid grid-cols-2 gap-4 text-sm bg-surface-50 dark:bg-surface-800/50 p-3 rounded-md"},Ge={class:"col-span-2"},He={class:"font-mono text-surface-900 dark:text-surface-0 break-all"},Je={key:0,class:"text-xs text-surface-500 mt-1 truncate"},Oe={class:"flex flex-col gap-1"},Qe={class:"flex items-center gap-1"},We={class:"font-mono"},Xe={key:0,class:"flex items-center gap-1"},Ze={class:"font-mono"},et={class:"text-primary-600 dark:text-primary-400 font-bold"},tt={class:"flex flex-col mt-1"},st={class:"text-[10px]"},ot={key:0,class:"text-xs"},lt={class:"p-2 bg-surface-50 dark:bg-surface-800/30 rounded border-l-2 border-primary-500 text-surface-600 dark:text-surface-300"},rt={class:"grid grid-cols-2 gap-2 pt-2"},it={key:2,class:"flex flex-col items-center justify-center py-12 bg-surface-0 dark:bg-surface-900 rounded-lg border border-dashed border-surface-300 dark:border-surface-700"},at=S({__name:"NodeListMobile",props:{nodes:{},loading:{type:Boolean}},emits:["edit","delete","stop","copy"],setup(o){function g(t){return new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(t)}function v(t){return[t.note1,t.note2,t.note3,t.note4].filter(Boolean).join(" | ")||"无备注"}function f(t){return!t||t===0?"长期有效":new Date(t*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function c(t){if(!t)return"";const n=Math.floor(Date.now()/1e3),i=t-n;if(i<0)return"已过期";const r=Math.floor(i/86400);return r===0?"今日到期":r<7?`${r} 天后到期`:""}function m(t){if(!t)return"";const n=Math.floor(Date.now()/1e3),i=t-n;return i<0?"text-red-500 font-medium":i<86400*7?"text-orange-500 font-medium":"text-surface-500"}return(t,n)=>(x(),b("div",Be,[o.loading?(x(),b("div",je,[...n[0]||(n[0]=[e("i",{class:"pi pi-spin pi-spinner text-3xl text-primary-500 mb-2"},null,-1),e("span",{class:"text-surface-500"},"加载中...",-1)])])):o.nodes.length>0?(x(!0),b(Z,{key:1},ee(o.nodes,i=>(x(),b("div",{key:i.id,class:"bg-surface-0 dark:bg-surface-900 rounded-lg shadow-sm border border-surface-200 dark:border-surface-700 p-4 space-y-4"},[e("div",Ke,[e("div",Re,[a(l(I),{value:i.server_group,severity:"info",class:"w-fit"},null,8,["value"]),e("div",Ae,[n[1]||(n[1]=e("i",{class:"pi pi-building text-xs"},null,-1)),e("span",qe,y(i.idc_name||"未知 IDC"),1)])]),a(l(I),{value:i.is_active?"运行中":"已停止",severity:i.is_active?"success":"danger",class:"px-2"},null,8,["value","severity"])]),e("div",Ye,[e("div",Ge,[n[2]||(n[2]=e("div",{class:"text-surface-500 dark:text-surface-400 text-[10px] uppercase tracking-wider mb-1"}," 连接地址 ",-1)),e("div",He,y(i.ip_address),1),i.domain?(x(),b("div",Je,y(i.domain),1)):U("",!0)]),e("div",null,[n[5]||(n[5]=e("div",{class:"text-surface-500 dark:text-surface-400 text-[10px] uppercase tracking-wider mb-1"}," 端口配置 ",-1)),e("div",Oe,[e("div",Qe,[n[3]||(n[3]=e("span",{class:"text-[10px] bg-surface-200 dark:bg-surface-700 px-1 rounded"},"代理",-1)),e("span",We,y(i.proxy_port),1)]),i.server_port?(x(),b("div",Xe,[n[4]||(n[4]=e("span",{class:"text-[10px] bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 px-1 rounded"},"服务",-1)),e("span",Ze,y(i.server_port),1)])):U("",!0)])]),e("div",null,[n[6]||(n[6]=e("div",{class:"text-surface-500 dark:text-surface-400 text-[10px] uppercase tracking-wider mb-1"}," 费用 / 到期 ",-1)),e("div",et,y(g(i.fee)),1),e("div",tt,[e("span",st,y(f(i.expire_ts)),1),i.expire_ts?(x(),b("span",{key:0,class:z([m(i.expire_ts),"text-[10px] font-bold"])},y(c(i.expire_ts)),3)):U("",!0)])])]),i.note1||i.note2||i.note3||i.note4?(x(),b("div",ot,[n[7]||(n[7]=e("div",{class:"text-surface-500 dark:text-surface-400 text-[10px] uppercase tracking-wider mb-1"}," 备注信息 ",-1)),e("div",lt,y(v(i)),1)])):U("",!0),e("div",rt,[a(l(k),{icon:"pi pi-pencil",label:"编辑",severity:"secondary",outlined:"",size:"small",onClick:r=>t.$emit("edit",i)},null,8,["onClick"]),a(l(k),{icon:"pi pi-stop",label:i.is_active?"停用节点":"已停用",severity:"danger",outlined:"",size:"small",disabled:!i.is_active,onClick:r=>t.$emit("stop",i)},null,8,["label","disabled","onClick"]),a(l(k),{icon:"pi pi-copy",label:"快速复用",severity:"info",outlined:"",size:"small",onClick:r=>t.$emit("copy",i)},null,8,["onClick"]),a(l(k),{icon:"pi pi-trash",label:"删除节点",severity:"danger",size:"small",onClick:r=>t.$emit("delete",i)},null,8,["onClick"])])]))),128)):(x(),b("div",it,[...n[8]||(n[8]=[e("i",{class:"pi pi-inbox text-4xl text-surface-300 dark:text-surface-600 mb-2"},null,-1),e("p",{class:"text-surface-500 dark:text-surface-400"},"暂无节点数据",-1)])]))]))}}),nt={class:"space-y-4"},dt=S({__name:"NodeList",props:{nodes:{},loading:{type:Boolean}},emits:["edit","delete","stop","copy"],setup(o){const g=V(!1);let v=null;const f=c=>{g.value=c.matches};return R(()=>{v=window.matchMedia("(max-width: 767px)"),g.value=v.matches,v.addEventListener("change",f)}),te(()=>{v&&v.removeEventListener("change",f)}),(c,m)=>(x(),b("div",nt,[g.value?(x(),F(at,{key:1,nodes:o.nodes,loading:o.loading,onEdit:m[4]||(m[4]=t=>c.$emit("edit",t)),onDelete:m[5]||(m[5]=t=>c.$emit("delete",t)),onStop:m[6]||(m[6]=t=>c.$emit("stop",t)),onCopy:m[7]||(m[7]=t=>c.$emit("copy",t))},null,8,["nodes","loading"])):(x(),F(Pe,{key:0,nodes:o.nodes,loading:o.loading,onEdit:m[0]||(m[0]=t=>c.$emit("edit",t)),onDelete:m[1]||(m[1]=t=>c.$emit("delete",t)),onStop:m[2]||(m[2]=t=>c.$emit("stop",t)),onCopy:m[3]||(m[3]=t=>c.$emit("copy",t))},null,8,["nodes","loading"]))]))}}),ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2"},ft={class:"flex flex-col gap-2"},mt={class:"flex flex-col gap-2"},ct={class:"flex flex-col gap-2"},pt={class:"flex flex-col gap-2"},vt={class:"flex flex-col gap-2"},xt={class:"flex flex-col gap-2"},gt={class:"flex flex-col gap-2"},bt={class:"flex flex-col gap-2"},yt={class:"flex flex-col gap-2"},_t={class:"flex flex-col gap-2"},$t={class:"flex flex-col gap-2"},kt={class:"flex flex-col gap-2"},Vt={class:"flex flex-col gap-2"},Ct={class:"flex flex-col gap-2"},wt={class:"flex flex-col gap-2 col-span-full"},Nt={class:"flex items-center gap-4"},ht={class:"flex items-center gap-2"},Dt={class:"flex items-center gap-2"},Ut=S({__name:"NodeDialog",props:{visible:{type:Boolean},mode:{},form:{},loading:{type:Boolean}},emits:["update:visible","save","cancel"],setup(o,{emit:g}){const v=o,f=g,c=q(),m=se({get:()=>v.visible,set:p=>f("update:visible",p)}),t=V(null),n=V(null);A(()=>v.form,p=>{p.rent_ts?t.value=new Date(p.rent_ts*1e3):t.value=null,p.expire_ts&&p.expire_ts>0?n.value=new Date(p.expire_ts*1e3):n.value=null},{immediate:!0,deep:!0});function i(p){if(!p)return!1;if(/^\d+$/.test(p)){const u=parseInt(p);return u>=0&&u<=65535}const s=p.match(/^(\d+)-(\d+)$/);if(s&&s[1]!==void 0&&s[2]!==void 0){const u=parseInt(s[1]),D=parseInt(s[2]);return u>=0&&u<=65535&&D>=0&&D<=65535&&u<=D}return!1}function r(){f("cancel")}function d(){if(!v.form.ip_address){c.add({severity:"error",summary:"错误",detail:"请输入 IP 地址",life:3e3});return}if(!v.form.server_group){c.add({severity:"error",summary:"错误",detail:"请输入节点分组",life:3e3});return}if(!i(v.form.proxy_port)){c.add({severity:"error",summary:"错误",detail:"代理端口格式不正确 (应为单个端口或范围，如 8080 或 20000-30000)",life:5e3});return}const p={...v.form};t.value&&(p.rent_ts=Math.floor(t.value.getTime()/1e3)),n.value?p.expire_ts=Math.floor(n.value.getTime()/1e3):p.expire_ts=0,f("save",p)}return(p,s)=>(x(),F(l(ne),{visible:m.value,"onUpdate:visible":s[16]||(s[16]=u=>m.value=u),header:o.mode==="add"?"新增代理节点":"编辑代理节点",modal:!0,style:{width:"50rem"},class:"p-fluid"},{footer:_(()=>[a(l(k),{label:"取消",icon:"pi pi-times",text:"",onClick:r}),a(l(k),{label:"保存",icon:"pi pi-check",loading:o.loading,onClick:d},null,8,["loading"])]),default:_(()=>[e("div",ut,[e("div",ft,[s[17]||(s[17]=e("label",{for:"ip_address",class:"font-bold"},[T("IP 地址 "),e("span",{class:"text-red-500"},"*")],-1)),a(l($),{id:"ip_address",modelValue:o.form.ip_address,"onUpdate:modelValue":s[0]||(s[0]=u=>o.form.ip_address=u),required:"",autofocus:"",class:z({"p-invalid":!o.form.ip_address})},null,8,["modelValue","class"])]),e("div",mt,[s[18]||(s[18]=e("label",{for:"domain",class:"font-bold"},"域名",-1)),a(l($),{id:"domain",modelValue:o.form.domain,"onUpdate:modelValue":s[1]||(s[1]=u=>o.form.domain=u),placeholder:"可选"},null,8,["modelValue"])]),e("div",ct,[s[19]||(s[19]=e("label",{for:"server_group",class:"font-bold"},[T("节点分组 "),e("span",{class:"text-red-500"},"*")],-1)),a(l($),{id:"server_group",modelValue:o.form.server_group,"onUpdate:modelValue":s[2]||(s[2]=u=>o.form.server_group=u),required:"",class:z({"p-invalid":!o.form.server_group})},null,8,["modelValue","class"]),s[20]||(s[20]=e("small",{class:"text-surface-500"},"同组节点共享 IDC、混淆口令、租金等属性",-1))]),e("div",pt,[s[21]||(s[21]=e("label",{for:"salamander",class:"font-bold"},"混淆口令 (Salamander)",-1)),a(l($),{id:"salamander",modelValue:o.form.salamander,"onUpdate:modelValue":s[3]||(s[3]=u=>o.form.salamander=u)},null,8,["modelValue"])]),e("div",vt,[s[22]||(s[22]=e("label",{for:"idc_name",class:"font-bold"},"IDC 供应商",-1)),a(l($),{id:"idc_name",modelValue:o.form.idc_name,"onUpdate:modelValue":s[4]||(s[4]=u=>o.form.idc_name=u)},null,8,["modelValue"])]),e("div",xt,[s[23]||(s[23]=e("label",{for:"fee",class:"font-bold"},"租用费用",-1)),a(l(B),{id:"fee",modelValue:o.form.fee,"onUpdate:modelValue":s[5]||(s[5]=u=>o.form.fee=u),mode:"currency",currency:"CNY",locale:"zh-CN"},null,8,["modelValue"])]),e("div",gt,[s[24]||(s[24]=e("label",{for:"proxy_port",class:"font-bold"},[T("代理端口 (Proxy Port) "),e("span",{class:"text-red-500"},"*")],-1)),a(l($),{id:"proxy_port",modelValue:o.form.proxy_port,"onUpdate:modelValue":s[6]||(s[6]=u=>o.form.proxy_port=u),placeholder:"例如: 8080 或 20000-30000",class:z({"p-invalid":!i(o.form.proxy_port)})},null,8,["modelValue","class"]),s[25]||(s[25]=e("small",{class:"text-surface-500"},"支持单个端口或端口范围 (0-65535)",-1))]),e("div",bt,[s[26]||(s[26]=e("label",{for:"server_port",class:"font-bold"},"服务端端口 (Server Port)",-1)),a(l(B),{id:"server_port",modelValue:o.form.server_port,"onUpdate:modelValue":s[7]||(s[7]=u=>o.form.server_port=u),useGrouping:!1,placeholder:"可选"},null,8,["modelValue"])]),e("div",yt,[s[27]||(s[27]=e("label",{for:"rent_ts",class:"font-bold"},"租用时间",-1)),a(l(j),{id:"rent_ts",modelValue:t.value,"onUpdate:modelValue":s[8]||(s[8]=u=>t.value=u),showIcon:"",showTime:"",hourFormat:"24",class:"w-full"},null,8,["modelValue"])]),e("div",_t,[s[28]||(s[28]=e("label",{for:"expire_ts",class:"font-bold"},"到期时间",-1)),a(l(j),{id:"expire_ts",modelValue:n.value,"onUpdate:modelValue":s[9]||(s[9]=u=>n.value=u),showIcon:"",showTime:"",hourFormat:"24",placeholder:"0 表示长期有效",class:"w-full"},null,8,["modelValue"])]),e("div",$t,[s[29]||(s[29]=e("label",{for:"note1",class:"font-bold"},"备注 1",-1)),a(l($),{id:"note1",modelValue:o.form.note1,"onUpdate:modelValue":s[10]||(s[10]=u=>o.form.note1=u)},null,8,["modelValue"])]),e("div",kt,[s[30]||(s[30]=e("label",{for:"note2",class:"font-bold"},"备注 2",-1)),a(l($),{id:"note2",modelValue:o.form.note2,"onUpdate:modelValue":s[11]||(s[11]=u=>o.form.note2=u)},null,8,["modelValue"])]),e("div",Vt,[s[31]||(s[31]=e("label",{for:"note3",class:"font-bold"},"备注 3",-1)),a(l($),{id:"note3",modelValue:o.form.note3,"onUpdate:modelValue":s[12]||(s[12]=u=>o.form.note3=u)},null,8,["modelValue"])]),e("div",Ct,[s[32]||(s[32]=e("label",{for:"note4",class:"font-bold"},"备注 4",-1)),a(l($),{id:"note4",modelValue:o.form.note4,"onUpdate:modelValue":s[13]||(s[13]=u=>o.form.note4=u)},null,8,["modelValue"])]),e("div",wt,[s[35]||(s[35]=e("label",{class:"font-bold mb-2"},"启用状态",-1)),e("div",Nt,[e("div",ht,[a(l(K),{modelValue:o.form.is_active,"onUpdate:modelValue":s[14]||(s[14]=u=>o.form.is_active=u),value:1,inputId:"active_on"},null,8,["modelValue"]),s[33]||(s[33]=e("label",{for:"active_on"},"启用",-1))]),e("div",Dt,[a(l(K),{modelValue:o.form.is_active,"onUpdate:modelValue":s[15]||(s[15]=u=>o.form.is_active=u),value:0,inputId:"active_off"},null,8,["modelValue"]),s[34]||(s[34]=e("label",{for:"active_off"},"禁用",-1))])])])])]),_:1},8,["visible","header"]))}}),It=P(Ut,[["__scopeId","data-v-3a278ff7"]]),St={class:"p-4 flex flex-col gap-4"},Mt=S({__name:"Node",setup(o){const{nodes:g,loading:v,filters:f,loadNodes:c,resetFilters:m}=ue(),{visible:t,loading:n,mode:i,form:r,currentNode:d,openAdd:p,openEdit:s,openCopy:u,close:D}=fe(),E=Y(),G=oe(),h=q();async function H(N){try{await E.refreshNode(N.id,{is_active:0}),h.add({severity:"success",summary:"成功",detail:`节点 ${N.ip_address} 已停用`,life:3e3})}catch(C){h.add({severity:"error",summary:"错误",detail:C.message||"停用失败",life:5e3})}}async function J(N){n.value=!0;try{i.value==="add"?(await E.addNode(N),h.add({severity:"success",summary:"成功",detail:"节点已新增",life:3e3})):d.value&&(await E.refreshNode(d.value.id,N),h.add({severity:"success",summary:"成功",detail:"节点已更新",life:3e3})),D(),c()}catch(C){h.add({severity:"error",summary:"错误",detail:C.message||"操作失败",life:5e3})}finally{n.value=!1}}function O(N){G.require({message:`确定要删除节点 "${N.ip_address}" 吗？此操作不可撤销。`,header:"删除确认",icon:"pi pi-exclamation-triangle",rejectLabel:"取消",acceptLabel:"确定",rejectProps:{label:"取消",severity:"secondary",outlined:!0},acceptProps:{label:"确定",severity:"danger"},accept:async()=>{try{await E.removeNode(N.id),h.add({severity:"success",summary:"成功",detail:"节点已删除",life:3e3}),c()}catch(C){h.add({severity:"error",summary:"错误",detail:C.message||"删除失败",life:5e3})}}})}return(N,C)=>(x(),b("div",St,[C[1]||(C[1]=e("div",{class:"flex justify-between items-center mb-2"},[e("h1",{class:"text-2xl font-bold"},"节点管理")],-1)),a(_e,{filters:l(f),onSearch:l(c),onReset:l(m),onAdd:l(p)},null,8,["filters","onSearch","onReset","onAdd"]),a(dt,{nodes:l(g),loading:l(v),onEdit:l(s),onDelete:O,onStop:H,onCopy:l(u)},null,8,["nodes","loading","onEdit","onCopy"]),a(It,{visible:l(t),"onUpdate:visible":C[0]||(C[0]=Q=>le(t)?t.value=Q:null),mode:l(i),form:l(r),loading:l(n),onSave:J,onCancel:l(D)},null,8,["visible","mode","form","loading","onCancel"]),a(l(de)),a(l(ie))]))}}),Rt=P(Mt,[["__scopeId","data-v-4f99785a"]]);export{Rt as default};
